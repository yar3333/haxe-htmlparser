package;

import haxe.Serializer;
import haxe.Unserializer;
import htmlparser.XmlParser;
import htmlparser.HtmlNodeElement;
import htmlparser.HtmlNodeText;
import htmlparser.XmlDocument;

#if sys
import sys.io.File;
#end

class XmlTest extends haxe.unit.TestCase
{
	public function testGoodXml()
	{
		try
		{
			new XmlDocument("<root><link></link></root>");
		}
		catch (_:Dynamic)
		{
			assertTrue(false);
			return;
		}
		assertTrue(true);
	}
    
	#if sys
	public function testComplexParse()
    {
		var s = File.getContent("inputA.xml");
		var doc = new XmlDocument(s);
		File.saveContent("outputA.xml", doc.toString());
		assertEquals(s, File.getContent("outputA.xml"));
    }
	#else
	public function testComplexParse()
    {
		var s = 
'<movieclip>
	<layer name="Layer 1">
		<frame>
			<shape>
				<fills>
					<fill type="solid" color="#0C85FE" />
					<fill type="solid" color="#68B4FD" />
					<fill type="solid" color="#2592FE" />
					<fill type="solid" color="#0176EB" />
					<fill type="solid" color="#016CD8" />
					<fill type="solid" color="#5B99FF" />
					<fill type="solid" color="#3591FF" />
					<fill type="solid" color="#369AFE" />
					<fill type="solid" color="#57ABFD" />
					<fill type="solid" color="#1288FE" />
					<fill type="solid" color="#3D9DFE" />
					<fill type="solid" color="#017CF8" />
				</fills>
				<strokes>
					<stroke type="solid" color="#01407E" ignoreScale="true" />
					<stroke type="solid" color="#333333" ignoreScale="true" />
				</strokes>
				<figure>
					<polygon fillIndex="0">
						<contour edges="M89.63,15.55L90.83,15.7L93.53,16.03L93.55,16.03C93.6,16.03,93.65,16.05C94.04,17.9,93.95,19.73C93.84,21.79,93.6,21.9C84.75,20.04,78.58,21.85C67.18,23.27,68.03,60.35C67.69,94.26,82.9,135.75C89.38,173.61,81.05,190.8C81,190.91,80.95,191.03C80.91,191.11,80.85,191.2C80.78,191.33,80.73,191.48C80.68,191.56,80.63,191.65C80.49,191.91,80.35,192.18L75.78,199.05L75,199.93C71.56,203.21,67.88,206.2C67.82,206.24,67.78,206.28C62.74,209.68,56.35,211.8C55.04,212.24,53.68,212.63C53.53,212.66,53.38,212.7L51.75,213.13C42.72,215.33,33.68,213.65C32.2,209.33,31.25,204.15C35.18,204.94,39.63,204.88C55.03,204.65,61.8,198.65C68.56,192.65,69.35,191.15C74.3,181.45,76.75,170.75C78.9,161.3,78.73,151.45C78.56,141.6,70,112.75C61.45,83.9,62.53,67.93C63.59,51.95,64.08,49.28C64.56,46.61,64.83,40.05C65.08,33.49,69.9,22.95C75.14,20.62,79.1,19.38L79.13,19.38C79.3,19.32,79.45,19.28C99.98,17.42,86.5,16.98C72.77,16.52,66.48,16.13C60.16,15.72,48.43,15.88C36.7,16.03,30.75,16.6C29.13,16.75,27.85,16.78C27.75,16.82,27.63,16.83L27.55,16.85C27.13,16.92,26.53,16.78C25.58,16.57,24.18,15.85C21.54,14.5,23.55,13C23.88,12.74,24.23,12.55C24.25,12.89,24.45,13.2C26.5,16.4,29.05,15.6C31.6,14.8,45.6,14.55C59.6,14.3,87.53,15.38L87.53,15.3C87.81,15.33,88.1,15.38C88.23,15.39,88.38,15.4C89,15.48,89.63,15.55" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M83.68,18.23C83.75,18.21,83.83,18.2C83.16,18.34,82.13,18.58L82.88,18.38C83,18.35,83.13,18.33L83.25,18.3L83.53,18.25C83.6,18.24,83.68,18.23" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M28.43,11.23C28.47,11.14,28.53,11.05L28.55,11.05C28.48,11.13,28.43,11.23" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M96.08,23.98C96.17,23.96,96.28,23.95C96.26,24,96.25,24.05L96.08,23.98" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M30.1,8.28C27.96,7.74,25.75,7.45C23.25,7.16,20.75,6.93C22.81,3.81,24.35,0.33C24.37,0.27,24.4,0.2C24.77,0.13,25.15,0.05C27.34,-0.24,28.08,2.38C28.11,2.45,28.13,2.53C28.37,2.57,28.6,2.65C30.5,3.2,31.38,5.1C30.85,6.74,30.1,8.28" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M2.18,161.45C2.64,165.27,3.3,169.1C6.04,184.85,15.13,194.98C16.21,196.18,17.38,197.25C17.53,203.11,18.38,208.1C14.01,205.75,9.65,202.5C3.08,196.9,0.38,189.6C-0.31,182.88,0.18,175.7L0.18,175.68C0.64,168.78,2.18,161.45" />
					</polygon>
					<polygon fillIndex="0">
						<contour edges="M14.68,24.5L15.55,25.08C15.76,25.23,15.98,25.38C10.43,26.83,9.1,33.2C8.15,37.65,8.3,42.25C8.35,44.1,8.6,46C10.25,60.6,11.05,75.4C11.85,90.2,13.7,104.85L14.05,105.98L14.08,106.03C14.22,106.71,14.23,107.08C14.24,107.32,14.2,107.43L14.2,107.48C14.21,107.52,14.23,107.58C14.15,107.9,14.13,108.08L14.13,108.13C13.91,112.05,13.5,112.3C11.59,116.82,7.1,115.55L6.98,113.45C7.43,113.45,6.93,112.8L6.88,112.13C7.9,112.5,9.2,112.5C9.85,112.5,10.45,112.3C10.85,112.25,11.05,111.9C12.05,110.35,12.25,108.48C12.27,108.47,12.3,108.45C12.24,108.26,12.18,108C11.8,106.25,11.55,104.45C11.2,102.25,11.15,99.95C11.05,97.5,10.9,95.15C10.7,92.7,10.6,90.35C10.5,88.05,10.35,85.55C10.25,83.4,10.05,81.15C9.85,78.85,9.6,76.65C9.3,74.3,9,71.8C8.75,69.55,8.55,67.35C8.35,65.05,8.15,62.8C8,60.55,7.75,58.3C7.5,56.1,7.45,53.8C7.45,52.65,7.3,51.55C6.95,49.2,6.65,46.7C6.35,44.55,6.35,42.4C6.4,40.2,6.3,37.85C6.25,35.8,6.5,33.7C6.75,31.3,8.15,29.2C9.4,27.35,12.38,25.53C13.87,24.61,14.68,24.5" />
					</polygon>
					<polygon fillIndex="1">
						<contour edges="M24.23,12.55C23.88,12.74,23.55,13C21.54,14.5,24.18,15.85C25.58,16.57,26.53,16.78C26.54,16.91,26.55,17.05C27.03,16.95,27.55,16.85L27.63,16.83C27.74,16.82,27.85,16.8L27.85,16.78C29.13,16.75,30.75,16.6C36.7,16.03,48.43,15.88C60.16,15.72,66.48,16.13C72.77,16.52,86.5,16.98C99.98,17.42,79.45,19.28C79.3,19.32,79.13,19.38L79.1,19.38L78.88,19.33L78.83,19.33C78.53,19.28,78.2,19.25C54.15,17.06,31.68,18.68C17.29,19.71,19.75,18.65C19.53,18.36,19.55,17.9C20,9.95,28.15,8.7C28.35,8.7,28.55,8.75C28.7,8.8,28.9,8.85C29.36,9.12,29.45,9.53L29.45,9.55L29.13,10.13L28.53,11.05C26.91,11.09,25.3,11.15C24.55,11.15,24.3,12C24.21,12.28,24.23,12.55" />
						<contour edges="M83.68,18.23C83.6,18.24,83.53,18.25L83.25,18.3L83.13,18.33C83,18.35,82.88,18.38L82.13,18.58C83.16,18.34,83.83,18.2C83.75,18.21,83.68,18.23" />
					</polygon>
					<polygon fillIndex="1">
						<contour edges="M48.43,45.15C48.11,37.14,46.35,29.25C46.25,29.15,46.15,29.1C45.6,28.7,45.8,28.3C47,28.5,47.95,29.45C49.27,33.45,50.05,37.6C50.74,41.32,51,45.15C51.95,60.3,46.15,74.25C45.4,74.85,44.65,74.25L44.55,74.05C44.35,73.8,44.35,73.5C47.2,66.1,48,58.35C48.7,51.71,48.43,45.15" />
					</polygon>
					<polygon fillIndex="1">
						<contour edges="M29.45,9.53C29.28,9.82,29.13,10.13C29.28,9.82,29.45,9.53" />
					</polygon>
					<polygon fillIndex="1">
						<contour edges="M29.7,190.38C22.64,187.62,18.1,181.05C21.89,144.23,44.83,82.88C27.67,152.42,29.7,190.38" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M89.63,15.55C89,15.48,88.38,15.4C89.03,15.43,89.7,15.45L89.63,15.55" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M26.53,16.78C27.13,16.92,27.55,16.85C27.03,16.95,26.55,17.05C26.54,16.91,26.53,16.78" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M27.63,16.83C27.75,16.82,27.85,16.78L27.85,16.8C27.74,16.82,27.63,16.83" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M79.1,19.38C75.14,20.62,69.9,22.95C65.08,33.49,64.83,40.05C64.56,46.61,64.08,49.28C63.59,51.95,62.53,67.93C61.45,83.9,70,112.75C78.56,141.6,78.73,151.45C78.9,161.3,76.75,170.75C74.3,181.45,69.35,191.15C68.56,192.65,61.8,198.65C55.03,204.65,39.63,204.88C35.18,204.94,31.25,204.15C30.1,197.88,29.7,190.38C39.08,194.05,52.9,191C73.16,171.95,62.45,124.95C51.74,77.95,52.15,27.5C51.08,32.68,50.05,37.6C49.27,33.45,47.95,29.45C47,28.5,45.8,28.3C45.6,28.7,46.15,29.1C46.25,29.15,46.35,29.25C48.11,37.14,48.43,45.15C36.81,98.78,28.6,118.45C19.55,140.1,13.8,162.95C12.25,169.2,14.9,175.25C16.3,178.45,18.1,181.05C17.2,189.85,17.38,197.25C16.21,196.18,15.13,194.98C6.04,184.85,3.3,169.1C2.64,165.27,2.18,161.45C4.14,152.08,7.88,142C11.28,132.79,16.15,123C16.74,121.81,17.33,120.6C27.99,98.59,38.7,66.5C41.85,53.79,41.35,41L41.3,40.1C41.1,35.7,40.45,31.3C35.98,19.97,18.38,21.98C17.05,21.31,16.28,20.4C15.41,19.41,15.2,18.13C14.81,15.68,15.35,14.13C17.55,11.32,19.65,8.5C20.21,7.72,20.75,6.93C23.25,7.16,25.75,7.45C27.96,7.74,30.1,8.28C29.79,8.91,29.45,9.53C29.36,9.12,28.9,8.85C28.7,8.8,28.55,8.75C28.35,8.7,28.15,8.7C20,9.95,19.55,17.9C19.53,18.36,19.75,18.65C17.29,19.71,31.68,18.68C54.15,17.06,78.2,19.25C78.53,19.28,78.83,19.33L78.88,19.33L79.1,19.38" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M13.18,23.53L14.68,24.5C13.87,24.61,12.38,25.53C9.4,27.35,8.15,29.2C6.75,31.3,6.5,33.7C6.25,35.8,6.3,37.85C6.4,40.2,6.35,42.4C6.35,44.55,6.65,46.7C6.95,49.2,7.3,51.55C7.45,52.65,7.45,53.8C7.5,56.1,7.75,58.3C8,60.55,8.15,62.8C8.35,65.05,8.55,67.35C8.75,69.55,9,71.8C9.3,74.3,9.6,76.65C9.85,78.85,10.05,81.15C10.25,83.4,10.35,85.55C10.5,88.05,10.6,90.35C10.7,92.7,10.9,95.15C11.05,97.5,11.15,99.95C11.2,102.25,11.55,104.45C11.8,106.25,12.18,108L12.25,108.48C12.05,110.35,11.05,111.9C10.85,112.25,10.45,112.3C9.85,112.5,9.2,112.5C7.9,112.5,6.88,112.13L6.73,109.65L10.5,109.05C9.85,107.3,9.85,105.45C9.85,104.45,9.65,103.55C9.15,101.5,9.05,99.45C8.95,97.15,8.7,94.85C8.45,92.55,8.2,90.35C7.95,88.05,7.75,85.75C7.55,83.45,7.45,81.25C7.35,79,7.15,76.6C6.95,74.4,6.85,72C6.8,69.8,6.6,67.5C6.35,65.2,6.05,62.95C5.75,60.65,5.55,58.35C5.3,55.95,5.15,53.8C5,51.35,4.85,48.95C4.7,46.5,4.45,44.25C4.2,41.8,3.9,39.43C4.05,37.4,4.35,35.25C4.75,32.8,5.48,30.43C5.69,29.74,5.93,29.08C5.94,29.04,5.98,29.03C7.15,27.2,8.95,25.9C10.85,24.45,13.18,23.53" />
					</polygon>
					<polygon fillIndex="2">
						<contour edges="M5.48,30.43L5.98,29.03L5.48,30.43" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M87.53,15.3L87.53,15.38C59.6,14.3,45.6,14.55C31.6,14.8,29.05,15.6C26.5,16.4,24.45,13.2C24.25,12.89,24.23,12.55C24.21,12.28,24.3,12C24.55,11.15,25.3,11.15C26.91,11.09,28.53,11.05C28.47,11.14,28.43,11.23L28.4,11.25C28.16,11.59,27.93,11.93C27.81,12.09,27.7,12.25L28.4,12.25C53.52,11.96,78.65,14.38C81.34,14.64,84.03,14.93C84.43,14.96,84.83,15C86.17,15.15,87.53,15.3" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M33.68,213.65C42.72,215.33,51.75,213.13L53.38,212.7C53.53,212.66,53.68,212.63C55.04,212.24,56.35,211.8C62.74,209.68,67.78,206.28C67.82,206.24,67.88,206.2C72.36,203.14,75.78,199.05L80.35,192.18C80.49,191.91,80.63,191.65C80.68,191.56,80.73,191.48C80.78,191.33,80.85,191.2C80.91,191.11,80.95,191.03C81,190.91,81.05,190.8C89.38,173.61,82.9,135.75C67.69,94.26,68.03,60.35C67.18,23.27,78.58,21.85C84.75,20.04,93.6,21.9C93.84,21.79,93.95,19.73C94.04,17.9,93.65,16.05C94.55,16.16,95.45,16.28C95.65,17.38,95.95,18.5C96.52,20.45,96.38,22.9C95.86,22.92,95,23.05C92.32,23.46,92,23.55C91.69,23.63,91.63,23.63L91.65,23.6L91.6,23.6C87.66,23.04,84.55,23.55C83.85,23.66,83.2,23.83L82.98,23.9C82.79,23.95,82.63,24C81.99,24.36,81.3,24.75C80.25,25.34,79.08,26C77.8,28.47,76.35,32.3C73.97,38.6,73.25,46.68C73.13,48,73.05,48.93C73.22,52.48,73.05,59.95C73.53,71.24,74.85,81.45C77.18,99.42,85.15,120.5C93.13,141.59,94.5,163.35C95.87,185.11,89.35,198.55C82.84,212,63.9,221C50.89,225.26,38.1,223.15C35.5,219.06,33.68,213.65" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M96.8,23.85L96.45,23.88C97.01,23.54,97.55,23.73C97.91,23.84,98.28,23.98C98.34,24,98.43,24.03C97.61,24.06,96.8,23.85" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M17.33,120.6C16.74,121.81,16.15,123C11.28,132.79,7.88,142C6.41,143.06,5.9,141.25C7.43,130.92,7.25,120.6C7.25,120.56,7.25,120.5L7.25,120.38C7.25,120.3,7.25,120.23C7.25,120.02,7.25,119.83C7.25,119.77,7.25,119.73C7.25,119.67,7.25,119.63C7.25,119.45,7.25,119.28C7.23,119.11,7.23,118.95C7.23,118.76,7.23,118.58L7.2,117.75L7.18,116.73C7.16,116.5,7.15,116.28L7.1,115.55C11.59,116.82,13.5,112.3C13.91,112.05,14.13,108.13L14.13,108.08C14.15,107.9,14.23,107.58C14.21,107.52,14.2,107.48L14.2,107.43C14.24,107.32,14.23,107.08C14.22,106.71,14.08,106.03L14.05,105.98L13.7,104.85C11.85,90.2,11.05,75.4C10.25,60.6,8.6,46C8.35,44.1,8.3,42.25C8.15,37.65,9.1,33.2C10.43,26.83,15.98,25.38C16.09,25.45,16.2,25.53L18.53,27.2C18.62,27.29,18.73,27.38C12.76,28.74,10.68,34.48L11.03,39.9L11.05,40.23C10.83,40.92,10.9,41.7C10.95,42.05,11.05,42.45C11.15,42.55,11.2,42.65L11.23,42.68L14.73,94.15L15.88,105.63L15.88,105.75L17.33,120.6" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M14.73,94.15L14.68,93.73L14.48,93.9L14.73,94.15" />
					</polygon>
					<polygon fillIndex="3">
						<contour edges="M3.95,205.78C3.58,204.72,3.25,203.65C1.12,196.9,0.38,189.6C3.08,196.9,9.65,202.5C14.01,205.75,18.38,208.1C19.22,213.15,20.78,217.3C12.31,212.97,3.95,205.78" />
					</polygon>
					<polygon fillIndex="4">
						<contour edges="M98.5,16.7C98.63,17.03,98.85,17.4C99,17.65,99.1,18C99.85,21,99.1,23.95L98.9,24C98.66,24.01,98.43,24.03C98.34,24,98.28,23.98C97.91,23.84,97.55,23.73C97.01,23.54,96.45,23.88L96.8,23.85L96.4,23.93C96.33,23.98,96.25,24.05C96.26,24,96.28,23.95C96.17,23.96,96.08,23.98C94.54,24.27,93.15,24.48C86.76,25.38,83.75,27.9C81.54,29.76,81.15,32.5C81.15,32.55,81.05,34.65C73.34,62.02,82.55,89C88.45,106.1,93,123.6C94.95,131.05,97.85,138.4C109.15,167.1,100.95,196C97.05,209.6,89.45,220.8C86.1,225.75,88.85,227.48C70.45,235.06,52.53,235C43.58,231.71,38.1,223.15C50.89,225.26,63.9,221C82.84,212,89.35,198.55C95.87,185.11,94.5,163.35C93.13,141.59,85.15,120.5C77.18,99.42,74.85,81.45C73.53,71.24,73.05,59.95C73.22,52.48,73.05,48.93C73.13,48,73.25,46.68C73.97,38.6,76.35,32.3C77.8,28.47,79.08,26C80.25,25.34,81.3,24.75C81.99,24.36,82.63,24C82.79,23.95,82.98,23.9L83.2,23.83C83.85,23.66,84.55,23.55C87.66,23.04,91.6,23.6L91.65,23.6L91.63,23.63C91.69,23.63,92,23.55C92.32,23.46,95,23.05C95.86,22.92,96.38,22.9C96.52,20.45,95.95,18.5C95.65,17.38,95.45,16.28L98.5,16.7" />
					</polygon>
					<polygon fillIndex="4">
						<contour edges="M96.4,23.93C96.33,23.94,96.28,23.95C96.33,23.94,96.4,23.93" />
					</polygon>
					<polygon fillIndex="4">
						<contour edges="M16.28,20.4C17.05,21.31,18.38,21.98C35.98,19.97,40.45,31.3C41.1,35.7,41.3,40.1L41.35,41C37.15,40.77,33.55,38.55C27.1,33.94,24.15,27L19.18,27.28C18.95,27.32,18.73,27.38C18.62,27.29,18.53,27.2L16.2,25.53C16.09,25.45,15.98,25.38C15.76,25.23,15.55,25.08L14.68,24.5L13.18,23.53C11.67,22.53,10.2,21.48C12.84,20.13,16.28,20.4" />
						<contour edges="M28.75,27.08C28.81,27.17,28.9,27.28C29.77,28.3,29.43,28.55C31.91,33.55,36.68,35.38C37.51,35.7,38.43,35.93C38.56,35.97,38.7,36C38.68,35.95,38.68,35.9C39.02,36.08,39.15,36.3C39.51,36.93,39.45,35.93C39.39,34.9,38.8,33.5C37.9,31.15,34.65,28.73C32.6,27.2,32.83,27.55C31.41,26.35,29.55,25.85C25.02,25.71,28.75,27.08" />
					</polygon>
					<polygon fillIndex="4">
						<contour edges="M14.73,94.15L14.48,93.9L14.68,93.73L14.73,94.15" />
					</polygon>
					<polygon fillIndex="4">
						<contour edges="M50.4,234.98C46.15,234.83,41.95,234.28C38.57,233.84,35.23,233.13L33.6,232.75C24.56,230.62,15.65,226.5C13.4,223.73,11.48,220.83C6.74,213.69,3.95,205.78C12.31,212.97,20.78,217.3C24.47,227.15,50.4,234.98" />
					</polygon>
					<polygon fillIndex="5">
						<contour edges="M10.2,21.48C11.67,22.53,13.18,23.53C10.85,24.45,8.95,25.9C7.15,27.2,5.98,29.03C7.42,25.07,9.9,21.65C10.05,21.56,10.2,21.48" />
					</polygon>
					<polygon fillIndex="5">
						<contour edges="M11.05,40.23L11.23,42.68L11.2,42.65C11.15,42.55,11.05,42.45C10.95,42.05,10.9,41.7C10.83,40.92,11.05,40.23" />
					</polygon>
					<polygon fillIndex="5">
						<contour edges="M3.9,39.43C4.2,41.8,4.45,44.25C4.7,46.5,4.85,48.95C5,51.35,5.15,53.8C5.3,55.95,5.55,58.35C5.75,60.65,6.05,62.95C6.35,65.2,6.6,67.5C6.8,69.8,6.85,72C6.95,74.4,7.15,76.6C7.35,79,7.45,81.25C7.55,83.45,7.75,85.75C7.95,88.05,8.2,90.35C8.45,92.55,8.7,94.85C8.95,97.15,9.05,99.45C9.15,101.5,9.65,103.55C9.85,104.45,9.85,105.45C9.85,107.3,10.5,109.05L6.73,109.65L3.65,56.25C3.1,47.98,3.9,39.43" />
					</polygon>
					<polygon fillIndex="5">
						<contour edges="M12.25,108.48L12.18,108C12.24,108.26,12.3,108.45C12.27,108.47,12.25,108.48" />
					</polygon>
					<polygon fillIndex="5">
						<contour edges="M6.93,112.8C7.43,113.45,6.98,113.45L6.95,113.23L6.93,112.8" />
					</polygon>
					<polygon fillIndex="6">
						<contour edges="M98.5,16.7C99.57,16.85,100.65,17C102.34,18.95,101.93,20.95C101.74,21.86,101.58,22.4C101.35,23.06,101.15,23.18C101.1,23.2,101.05,23.23C100.7,23.4,100.35,23.55C99.74,23.79,99.1,23.95C99.85,21,99.1,18C99,17.65,98.85,17.4C98.63,17.03,98.5,16.7" />
					</polygon>
					<polygon fillIndex="6">
						<contour edges="M67.88,206.2C71.56,203.21,75,199.93L75.78,199.05C72.36,203.14,67.88,206.2" />
					</polygon>
					<polygon fillIndex="6">
						<contour edges="M88.85,227.48C86.1,225.75,89.45,220.8C97.05,209.6,100.95,196C109.15,167.1,97.85,138.4C94.95,131.05,93,123.6C88.45,106.1,82.55,89C73.34,62.02,81.05,34.65C80.86,38.8,80.3,50.98L80.3,51.18C79.51,69.39,85.75,85.33C87.06,88.68,90.23,98.95C90.28,99.16,90.35,99.38C96.81,116.6,106.33,146.88C120.64,192.4,91.15,226.5C90,227,88.85,227.48" />
					</polygon>
					<polygon fillIndex="6">
						<contour edges="M38.68,35.9C36.46,29.47,28.75,27.08C25.02,25.71,29.55,25.85C31.41,26.35,32.83,27.55C32.6,27.2,34.65,28.73C37.9,31.15,38.8,33.5C39.39,34.9,39.45,35.93C39.51,36.93,39.15,36.3C39.02,36.08,38.68,35.9" />
					</polygon>
					<polygon fillIndex="7">
						<contour edges="M18.1,181.05C16.3,178.45,14.9,175.25C12.25,169.2,13.8,162.95C19.55,140.1,28.6,118.45C36.81,98.78,48.43,45.15C48.7,51.71,48,58.35C47.2,66.1,44.35,73.5C44.35,73.8,44.55,74.05L44.65,74.25C45.4,74.85,46.15,74.25C51.95,60.3,51,45.15C50.74,41.32,50.05,37.6C51.08,32.68,52.15,27.5C51.74,77.95,62.45,124.95C73.16,171.95,52.9,191C39.08,194.05,29.7,190.38C27.67,152.42,44.83,82.88C21.89,144.23,18.1,181.05" />
					</polygon>
					<polygon fillIndex="8">
						<contour edges="M17.38,197.25C17.2,189.85,18.1,181.05C22.64,187.62,29.7,190.38C30.1,197.88,31.25,204.15C23.21,202.51,17.38,197.25" />
					</polygon>
					<polygon fillIndex="9">
						<contour edges="M18.38,208.1C26.03,212.25,33.68,213.65C35.5,219.06,38.1,223.15C29.39,221.71,20.78,217.3C19.22,213.15,18.38,208.1" />
					</polygon>
					<polygon fillIndex="10">
						<contour edges="M31.25,204.15C32.2,209.33,33.68,213.65C26.03,212.25,18.38,208.1C17.53,203.11,17.38,197.25C23.21,202.51,31.25,204.15" />
					</polygon>
					<polygon fillIndex="11">
						<contour edges="M38.1,223.15C43.58,231.71,52.53,235C51.46,235,50.4,234.98C24.47,227.15,20.78,217.3C29.39,221.71,38.1,223.15" />
					</polygon>
					<edge strokeIndex="0" edges="M99.1,23.95C99.74,23.79,100.35,23.55C100.7,23.4,101.05,23.23C101.1,23.2,101.15,23.18C101.35,23.06,101.58,22.4C101.74,21.86,101.93,20.95C102.34,18.95,100.65,17C99.57,16.85,98.5,16.7L95.45,16.28C94.55,16.16,93.65,16.05M93.55,16.03L93.53,16.03L90.83,15.7L89.63,15.55M87.53,15.3C86.17,15.15,84.83,15C84.43,14.96,84.03,14.93C81.34,14.64,78.65,14.38C53.52,11.96,28.4,12.25L27.7,12.25C27.81,12.09,27.93,11.93C28.16,11.59,28.4,11.25L28.43,11.23M52.53,235C70.45,235.06,88.85,227.48M81.15,32.5C81.54,29.76,83.75,27.9C86.76,25.38,93.15,24.48C94.54,24.27,96.08,23.98M96.8,23.85C97.61,24.06,98.43,24.03M81.05,34.65C80.86,38.8,80.3,50.98L80.3,51.18C79.51,69.39,85.75,85.33C87.06,88.68,90.23,98.95C90.28,99.16,90.35,99.38C96.81,116.6,106.33,146.88C120.64,192.4,91.15,226.5C90,227,88.85,227.48M29.45,9.53C29.79,8.91,30.1,8.28C30.85,6.74,31.38,5.1C30.5,3.2,28.6,2.65C28.37,2.57,28.13,2.53C28.11,2.45,28.08,2.38C27.34,-0.24,25.15,0.05C24.77,0.13,24.4,0.2C24.37,0.27,24.35,0.33C22.81,3.81,20.75,6.93C20.21,7.72,19.65,8.5C17.55,11.32,15.35,14.13C14.81,15.68,15.2,18.13C15.41,19.41,16.28,20.4C17.05,21.31,18.38,21.98C35.98,19.97,40.45,31.3C41.1,35.7,41.3,40.1L41.35,41C41.85,53.79,38.7,66.5C27.99,98.59,17.33,120.6C16.74,121.81,16.15,123C11.28,132.79,7.88,142C4.14,152.08,2.18,161.45M29.13,10.13L28.53,11.05M29.13,10.13C29.28,9.82,29.45,9.53M16.28,20.4C12.84,20.13,10.2,21.48C10.05,21.56,9.9,21.65C7.42,25.07,5.98,29.03M19.18,27.28L24.15,27C27.1,33.94,33.55,38.55C37.15,40.77,41.35,41M18.73,27.38C12.76,28.74,10.68,34.48L11.03,39.9M11.23,42.68L14.73,94.15L15.88,105.63L15.88,105.75L17.33,120.6M5.48,30.43C4.75,32.8,4.35,35.25C4.05,37.4,3.9,39.43C3.1,47.98,3.65,56.25L6.73,109.65L6.88,112.13M7.15,116.28C7.16,116.5,7.18,116.73L7.2,117.75L7.23,118.58C7.23,118.76,7.23,118.95C7.23,119.11,7.25,119.28C7.25,119.45,7.25,119.63C7.25,119.67,7.25,119.73C7.25,119.77,7.25,119.83C7.25,120.02,7.25,120.23C7.25,120.3,7.25,120.38L7.25,120.5C7.25,120.56,7.25,120.6C7.43,130.92,5.9,141.25C6.41,143.06,7.88,142M6.98,113.45L7.1,115.55M0.38,189.6C-0.31,182.88,0.18,175.7L0.18,175.68C0.64,168.78,2.18,161.45M52.53,235C51.46,235,50.4,234.98C46.15,234.83,41.95,234.28C38.57,233.84,35.23,233.13L33.6,232.75C24.56,230.62,15.65,226.5C13.4,223.73,11.48,220.83C6.74,213.69,3.95,205.78C3.58,204.72,3.25,203.65C1.12,196.9,0.38,189.6" />
					<edge strokeIndex="1" edges="M89.63,15.55C89,15.48,88.38,15.4C88.23,15.39,88.1,15.38C87.81,15.33,87.53,15.3M28.43,11.23C28.47,11.14,28.53,11.05M81.05,34.65C81.15,32.55,81.15,32.5M96.08,23.98C96.17,23.96,96.28,23.95C96.33,23.94,96.4,23.93L96.8,23.85M98.43,24.03C98.66,24.01,98.9,24L99.1,23.95M11.05,40.23L11.23,42.68M5.98,29.03L5.48,30.43M7.1,115.55L7.15,116.28M6.88,112.13L6.93,112.8M6.98,113.45L6.95,113.23L6.93,112.8" />
				</figure>
			</shape>
		</frame>
	</layer>
</movieclip>';
		var doc = new XmlDocument(s);
		assertEquals(s, doc.toString());
    }
	
	#end
	
	public function testSerialization()
	{
		var text = "<root>text1<link>text2</link>text3</root>";
		
		var doc = new XmlDocument(text);
		assertEquals(text, doc.innerHTML);
		
		#if (js && jsprop)
			// innerHTML is native js property, so we not need to specify type for doc2	
		var doc2 = Unserializer.run(Serializer.run(doc));
		#else
			// innerHTML is a haxe property, so we need to specify type to correct call get_innerHTML() in code below
			var doc2 : XmlDocument = Unserializer.run(Serializer.run(doc));
		#end
		assertEquals(text, doc2.innerHTML);
	}
	
	public function testInnerText()
	{
		var text = "<root>text1<link>text2&amp;</link>te<![CDATA[4&amp;10]]>xt3</root>";
		
		var doc = new XmlDocument(text);
		assertEquals("text1text2&te4&amp;10xt3", doc.innerText);
	}
	
	public function testComplexAttr()
	{
		var text = "<root xlink:href='abc' />";
		
		var doc = new XmlDocument(text);
		assertEquals("abc", doc.children[0].getAttribute("xlink:href"));
	}
	
	public function testGetEscapedAttr()
	{
		var text = "<a href='abc&amp;def' />";
		
		var doc = new XmlDocument(text);
		assertEquals("abc&def", doc.children[0].getAttribute("href"));
	}
	
	public function testSetEscapedAttr()
	{
		var text = "<a />";
		
		var doc = new XmlDocument(text);
		doc.children[0].setAttribute("href", "abc&def");
		assertEquals("<a href=\"abc&amp;def\" />", doc.toString());
	}
}
